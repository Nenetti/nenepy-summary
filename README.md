# Pytorch Model Summary

# Installation

```Shell
pip install git+https://github.com/Nenetti/nenepy-summary.git
```

# Examples

Pleas show [summary_example.py](./example/summary_example.py)

## ResNet-18
```python
from torchvision.models import resnet18
from nenepy_summary import TorchSummary

resnet = resnet18(pretrained=False)

summary = TorchSummary(model=resnet, batch_size=16, is_train=True)
output = summary.forward_size([3, 256, 256])
```

```
=====================================│============================│========================│===========================================│===========│
                                     │                            │                        │                 Parameter                 │           │
                                     │                            │                        │ ----------------------------------------- │ Time (ms) │
        Network Architecture         │           Input            │         Output         │           │       │       │ Requires Grad │           │
                                     │                            │                        │   Weight  │  Bias │ Train │ ------------- │           │
                                     │                            │                        │           │       │       │ Weight / Bias │           │
=====================================│============================│========================│===========================================│===========│
(1) ResNet                           │        [16,   3, 256, 256] │   [16, 1000]           │         - │     - │   ✓   │   -       -   │    302.03 │
   ├ (2) Conv2d                      │        [16,   3, 256, 256] │   [16,   64, 128, 128] │     9,408 │     - │   ✓   │   ✓       -   │    287.03 │
   ├ (3) BatchNorm2d                 │        [16,  64, 128, 128] │   [16,   64, 128, 128] │        64 │    64 │   ✓   │   ✓       ✓   │      1.10 │
   ├ (4) ReLU                        │        [16,  64, 128, 128] │   [16,   64, 128, 128] │         - │     - │   ✓   │   -       -   │       .05 │
   ├ (5) MaxPool2d                   │        [16,  64, 128, 128] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │       .30 │
   │                                 │                            │                        │           │       │       │               │           │
   ├ (6) Sequential                  │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │      3.15 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    ├ (7) BasicBlock             │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │      1.79 │
   │    │    ├ (8) Conv2d            │        [16,  64,  64,  64] │   [16,   64,  64,  64] │    36,864 │     - │   ✓   │   ✓       -   │       .46 │
   │    │    ├ (9) BatchNorm2d       │        [16,  64,  64,  64] │   [16,   64,  64,  64] │        64 │    64 │   ✓   │   ✓       ✓   │       .18 │
   │    │    ├ (10) ReLU             │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │    ├ (11) Conv2d           │        [16,  64,  64,  64] │   [16,   64,  64,  64] │    36,864 │     - │   ✓   │   ✓       -   │       .34 │
   │    │    ├ (12) BatchNorm2d      │        [16,  64,  64,  64] │   [16,   64,  64,  64] │        64 │    64 │   ✓   │   ✓       ✓   │       .18 │
   │    │    └ (*10) ReLU            │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    └ (13) BasicBlock            │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │      1.22 │
   │         ├ (14) Conv2d           │        [16,  64,  64,  64] │   [16,   64,  64,  64] │    36,864 │     - │   ✓   │   ✓       -   │       .15 │
   │         ├ (15) BatchNorm2d      │        [16,  64,  64,  64] │   [16,   64,  64,  64] │        64 │    64 │   ✓   │   ✓       ✓   │       .18 │
   │         ├ (16) ReLU             │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │       .02 │
   │         ├ (17) Conv2d           │        [16,  64,  64,  64] │   [16,   64,  64,  64] │    36,864 │     - │   ✓   │   ✓       -   │       .16 │
   │         ├ (18) BatchNorm2d      │        [16,  64,  64,  64] │   [16,   64,  64,  64] │        64 │    64 │   ✓   │   ✓       ✓   │       .18 │
   │         └ (*16) ReLU            │        [16,  64,  64,  64] │   [16,   64,  64,  64] │         - │     - │   ✓   │   -       -   │       .02 │
   │                                 │                            │                        │           │       │       │               │           │
   ├ (19) Sequential                 │        [16,  64,  64,  64] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │      3.05 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    ├ (20) BasicBlock            │        [16,  64,  64,  64] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │      1.85 │
   │    │    ├ (21) Conv2d           │        [16,  64,  64,  64] │   [16,  128,  32,  32] │    73,728 │     - │   ✓   │   ✓       -   │       .25 │
   │    │    ├ (22) BatchNorm2d      │        [16, 128,  32,  32] │   [16,  128,  32,  32] │       128 │   128 │   ✓   │   ✓       ✓   │       .18 │
   │    │    ├ (23) ReLU             │        [16, 128,  32,  32] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │    ├ (24) Conv2d           │        [16, 128,  32,  32] │   [16,  128,  32,  32] │   147,456 │     - │   ✓   │   ✓       -   │       .35 │
   │    │    ├ (25) BatchNorm2d      │        [16, 128,  32,  32] │   [16,  128,  32,  32] │       128 │   128 │   ✓   │   ✓       ✓   │       .07 │
   │    │    │                       │                            │                        │           │       │       │               │           │
   │    │    ├ (26) Sequential       │        [16,  64,  64,  64] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │       .33 │
   │    │    │    ├ (27) Conv2d      │        [16,  64,  64,  64] │   [16,  128,  32,  32] │     8,192 │     - │   ✓   │   ✓       -   │       .08 │
   │    │    │    └ (28) BatchNorm2d │        [16, 128,  32,  32] │   [16,  128,  32,  32] │       128 │   128 │   ✓   │   ✓       ✓   │       .07 │
   │    │    └ (*23) ReLU            │        [16, 128,  32,  32] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    └ (29) BasicBlock            │        [16, 128,  32,  32] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │      1.06 │
   │         ├ (30) Conv2d           │        [16, 128,  32,  32] │   [16,  128,  32,  32] │   147,456 │     - │   ✓   │   ✓       -   │       .18 │
   │         ├ (31) BatchNorm2d      │        [16, 128,  32,  32] │   [16,  128,  32,  32] │       128 │   128 │   ✓   │   ✓       ✓   │       .07 │
   │         ├ (32) ReLU             │        [16, 128,  32,  32] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │       .02 │
   │         ├ (33) Conv2d           │        [16, 128,  32,  32] │   [16,  128,  32,  32] │   147,456 │     - │   ✓   │   ✓       -   │       .18 │
   │         ├ (34) BatchNorm2d      │        [16, 128,  32,  32] │   [16,  128,  32,  32] │       128 │   128 │   ✓   │   ✓       ✓   │       .07 │
   │         └ (*32) ReLU            │        [16, 128,  32,  32] │   [16,  128,  32,  32] │         - │     - │   ✓   │   -       -   │       .02 │
   │                                 │                            │                        │           │       │       │               │           │
   ├ (35) Sequential                 │        [16, 128,  32,  32] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │      2.52 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    ├ (36) BasicBlock            │        [16, 128,  32,  32] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │      1.58 │
   │    │    ├ (37) Conv2d           │        [16, 128,  32,  32] │   [16,  256,  16,  16] │   294,912 │     - │   ✓   │   ✓       -   │       .22 │
   │    │    ├ (38) BatchNorm2d      │        [16, 256,  16,  16] │   [16,  256,  16,  16] │       256 │   256 │   ✓   │   ✓       ✓   │       .07 │
   │    │    ├ (39) ReLU             │        [16, 256,  16,  16] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │    ├ (40) Conv2d           │        [16, 256,  16,  16] │   [16,  256,  16,  16] │   589,824 │     - │   ✓   │   ✓       -   │       .19 │
   │    │    ├ (41) BatchNorm2d      │        [16, 256,  16,  16] │   [16,  256,  16,  16] │       256 │   256 │   ✓   │   ✓       ✓   │       .07 │
   │    │    │                       │                            │                        │           │       │       │               │           │
   │    │    ├ (42) Sequential       │        [16, 128,  32,  32] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .42 │
   │    │    │    ├ (43) Conv2d      │        [16, 128,  32,  32] │   [16,  256,  16,  16] │    32,768 │     - │   ✓   │   ✓       -   │       .13 │
   │    │    │    └ (44) BatchNorm2d │        [16, 256,  16,  16] │   [16,  256,  16,  16] │       256 │   256 │   ✓   │   ✓       ✓   │       .07 │
   │    │    └ (*39) ReLU            │        [16, 256,  16,  16] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    └ (45) BasicBlock            │        [16, 256,  16,  16] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .81 │
   │         ├ (46) Conv2d           │        [16, 256,  16,  16] │   [16,  256,  16,  16] │   589,824 │     - │   ✓   │   ✓       -   │       .06 │
   │         ├ (47) BatchNorm2d      │        [16, 256,  16,  16] │   [16,  256,  16,  16] │       256 │   256 │   ✓   │   ✓       ✓   │       .07 │
   │         ├ (48) ReLU             │        [16, 256,  16,  16] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .02 │
   │         ├ (49) Conv2d           │        [16, 256,  16,  16] │   [16,  256,  16,  16] │   589,824 │     - │   ✓   │   ✓       -   │       .06 │
   │         ├ (50) BatchNorm2d      │        [16, 256,  16,  16] │   [16,  256,  16,  16] │       256 │   256 │   ✓   │   ✓       ✓   │       .07 │
   │         └ (*48) ReLU            │        [16, 256,  16,  16] │   [16,  256,  16,  16] │         - │     - │   ✓   │   -       -   │       .02 │
   │                                 │                            │                        │           │       │       │               │           │
   ├ (51) Sequential                 │        [16, 256,  16,  16] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │      2.64 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    ├ (52) BasicBlock            │        [16, 256,  16,  16] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │      1.67 │
   │    │    ├ (53) Conv2d           │        [16, 256,  16,  16] │   [16,  512,   8,   8] │ 1,179,648 │     - │   ✓   │   ✓       -   │       .17 │
   │    │    ├ (54) BatchNorm2d      │        [16, 512,   8,   8] │   [16,  512,   8,   8] │       512 │   512 │   ✓   │   ✓       ✓   │       .07 │
   │    │    ├ (55) ReLU             │        [16, 512,   8,   8] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │    ├ (56) Conv2d           │        [16, 512,   8,   8] │   [16,  512,   8,   8] │ 2,359,296 │     - │   ✓   │   ✓       -   │       .30 │
   │    │    ├ (57) BatchNorm2d      │        [16, 512,   8,   8] │   [16,  512,   8,   8] │       512 │   512 │   ✓   │   ✓       ✓   │       .07 │
   │    │    │                       │                            │                        │           │       │       │               │           │
   │    │    ├ (58) Sequential       │        [16, 256,  16,  16] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .44 │
   │    │    │    ├ (59) Conv2d      │        [16, 256,  16,  16] │   [16,  512,   8,   8] │   131,072 │     - │   ✓   │   ✓       -   │       .19 │
   │    │    │    └ (60) BatchNorm2d │        [16, 512,   8,   8] │   [16,  512,   8,   8] │       512 │   512 │   ✓   │   ✓       ✓   │       .07 │
   │    │    └ (*55) ReLU            │        [16, 512,   8,   8] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .02 │
   │    │                            │                            │                        │           │       │       │               │           │
   │    └ (61) BasicBlock            │        [16, 512,   8,   8] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .80 │
   │         ├ (62) Conv2d           │        [16, 512,   8,   8] │   [16,  512,   8,   8] │ 2,359,296 │     - │   ✓   │   ✓       -   │       .06 │
   │         ├ (63) BatchNorm2d      │        [16, 512,   8,   8] │   [16,  512,   8,   8] │       512 │   512 │   ✓   │   ✓       ✓   │       .07 │
   │         ├ (64) ReLU             │        [16, 512,   8,   8] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .02 │
   │         ├ (65) Conv2d           │        [16, 512,   8,   8] │   [16,  512,   8,   8] │ 2,359,296 │     - │   ✓   │   ✓       -   │       .06 │
   │         ├ (66) BatchNorm2d      │        [16, 512,   8,   8] │   [16,  512,   8,   8] │       512 │   512 │   ✓   │   ✓       ✓   │       .07 │
   │         └ (*64) ReLU            │        [16, 512,   8,   8] │   [16,  512,   8,   8] │         - │     - │   ✓   │   -       -   │       .02 │
   ├ (67) AdaptiveAvgPool2d          │        [16, 512,   8,   8] │   [16,  512,   1,   1] │         - │     - │   ✓   │   -       -   │       .06 │
   └ (68) Linear                     │        [16, 512]           │   [16, 1000]           │   512,000 │ 1,000 │   ✓   │   ✓       ✓   │      1.11 │
=====================================│============================│========================│===========================================│===========│
                                     │                            │                        │           │       │       │ Weight / Bias │           │
                                     │                            │                        │   Weight  │  Bias │ Train │ ------------- │           │
        Network Architecture         │           Input            │         Output         │           │       │       │ Requires Grad │           │
                                     │                            │                        │ ----------------------------------------- │ Time (ms) │
                                     │                            │                        │                 Parameter                 │           │
=====================================│============================│========================│===========================================│===========│

               Total Params: 11,689,512
        Total Weight Params: 11,683,712
          Total Bias Params:      5,800

     Total Trainable Params: 11,689,512
    Trainable Weight Params: 11,683,712
      Trainable Bias Params:      5,800

 Total Non-Trainable Params:          0
Non-Trainable Weight Params:          0
  Non-Trainable Bias Params:          0


          Total Params (MB):      44.63

            Total Size (MB):   1,950.00

           Conv2d: 20   (torch.nn.modules.conv.Conv2d)
      BatchNorm2d: 20   (torch.nn.modules.batchnorm.BatchNorm2d)
             ReLU: 17   (torch.nn.modules.activation.ReLU)
       BasicBlock:  8   (torchvision.models.resnet.BasicBlock)
       Sequential:  7   (torch.nn.modules.container.Sequential)
           ResNet:  1   (torchvision.models.resnet.ResNet)
        MaxPool2d:  1   (torch.nn.modules.pooling.MaxPool2d)
AdaptiveAvgPool2d:  1   (torch.nn.modules.pooling.AdaptiveAvgPool2d)
           Linear:  1   (torch.nn.modules.linear.Linear)
```

```python
print(output.shape)
# torch.Size([16, 1000])
```